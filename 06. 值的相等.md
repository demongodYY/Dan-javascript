是时候讨论一下 JavaScript 的相等了！我会告诉你为什么这很重要。

想象一下我们在蒙面嘉年华上洽谈业务交易。你会跟两个人交谈，却无法意识到你是不是跟同一个人交谈了两次。又或者你可能会认为跟你交谈的是同一个人，但其实是不同的两个人！

![image](https://user-images.githubusercontent.com/17036920/113999975-21cfa880-988d-11eb-895c-87dfb7217a4f.png)

**如果你对于 JavaScript 的相等模型了解的不是很清楚，那每天就都像是一场蒙面舞会 —— 这可不是一个好主意。** 你用于不会十分确定你是否在处理同样的值，还是两个不同的值。最后的结果就是，你会犯错 —— 比如说改变了你笨不想改变的值。

幸运的是，我们已经对了解 JavaScript 中相等的概念做了很多功课。它会很自然地进入到我们的思维模式中。

## 相等的种类

在 JavaScript 中，有几种相等的方式。如果你写过一阵 JavaScript，你可能会对以下至少两种方式比较熟悉：

- **严格相等:** a === b (三个等号)
- - **不严格相等:** a == b (量个等号)
- - **同值相等:** Object.is(a, b)

许多教程里都根本不会提到 ***同值相等。*** 我们不走寻常路，就从它开始解释吧。接着我们就能用它去解释其他的种类了：

### 同值相等： Object.is(a, b)

在 JavaScript 中， `Object.is(a, b)` 告诉我们 `a` 和 `b` 是否有相同的值：

```js
console.log(Object.is(2, 2)); // true
console.log(Object.is({}, {})); // false
```

这就叫 **同值相等。**

事实上，在我们的思维模式里，什么是”同值“呢？。你可能从直觉上已经有了解了，但是还是让我们验证一下。

### 检验你的直觉

考虑下面这个例子：

```js
let dwarves = 7;
let continents = '7';
let worldWonders = 3 + 4;
```

就跟我们了解的一样，对于这个代码片段的草图会像这样：

![image](https://user-images.githubusercontent.com/17036920/115334251-9ed41980-a1cd-11eb-90f2-cfafc3556bd3.png)

现在试着用**上面的图**去回答下面的问题：

```js
console.log(Object.is(dwarves, continents)); // ?
console.log(Object.is(continents, worldWonders)); // ?
console.log(Object.is(worldWonders, dwarves)); // ?
```

写下你的答案，并且想想你该如何解释

### 占位

在完成之前不要滚动下来...

...

....

...

...

...

这不是一个大问题！这里是答案：

1. `Object.is(dwarves, continents)` 是返回 `false` 值，因为 `dwarves` 和 `continents` 是不同的值。
2. `Object.is(continents, worldWonders)` 是 `false`，它们也是不同的值。
3. `Object.is(worldWonders, dwarves)` 是 `true`，它们是同一个值。

如果两个值在我们的图中用同一个形状来表示，那意味着它们并不真正是两个不同的值。它们是同一个值！这时候 `Object.is(a,b)` 就会返回 `true`。

在前面的模块里，我们“数”了所有的值。但事实上，我们是学习了是什么造成了值与值之间的区分。因此，我们同样也学习了它的反面 —— 什么意味着值是同一个。

如果你对这个观点还很困惑的话，你可以回看之前的章节，并且重新做一遍[练习题](https://click.convertkit-mail.com/n4ud8kp9r0iqu358m3i0/p8hehqu5px3dz4hq/aHR0cHM6Ly9lZ2doZWFkaW8udHlwZWZvcm0uY29tL3RvL1NURWVNeT9lbWFpbD15eXV1cXFpaUBvdXRsb29rLmNvbQ==)。我保证这是合理的!

### 但关于对象呢？

在这个观点下，你可能会对对象感到忧虑。你可能听说过相等性在对象里不起作用，或者说它们比较的是“引用”。 **如果你仍然有这样的直觉，请暂时将它们完全抛开。**

取而代之，看看下面的代码片段：

```js
let banana = {};
let cherry = banana;
let chocolate = cherry;
cherry = {};
```

打开你的笔记本或者可以话草稿的 app, 画下这些变量和值的图。这有些困难，因此你最好一步一步地去画。

记住，`{}` 永远意味着“创建一个新的对象值”。同样记住 `=` 意味着“将左边的线连接到右边的值”。

**在你画完之后，** 写下你的答案：

```js
console.log(Object.is(banana, cherry)); // ?
console.log(Object.is(cherry, chocolate)); // ?
console.log(Object.is(chocolate, banana)); // ?
```

确保你用图画来回答了问题。

### 占位

在完成之前不要滚动下来...

...

....

...

...

...

你画图应该是如下的步骤

![img](https://res.cloudinary.com/dg3gyk0gu/image/upload/v1582119851/just-javascript-email-images/jj06/banana-anim-final.gif)

1. `let banana = {}`
  - 声明 banana 变量
  - 创建了一个新的对象值 {}
  - 将 banana 变量连接到它 
2. `let cherry = banana`
  - 声明 cherry 变量
  - 将 cherry 变量连接到 banana 变量连接到的地方
3. `let chocolate = cherry`
  - 声明了 chocolate 变量
  - 将 chocolate 变量连接到 cherry 变量连接到的地方
4. `cherry = {}`
  - 创建一个新的对象值 {}
  - 将 cherry 变量连接到它

完成了所有步骤后，你应该得到如下的图：

![image](https://user-images.githubusercontent.com/17036920/115335500-ec518600-a1cf-11eb-8040-405dc150c0c7.png)

现在来看看答案:

1. `Object.is(banana, cherry)` 是 `false`， 它们连接到了不同的值。
2. `Object.is(cherry, chocolate)` 是 `false`，它们也连接了不同的值。
3. `Object.is(chocolate, banana)` 是 `true`， 它们连接了同一个值。

如你所见，我们没有在对象是否相等中添加如何额外的概念。它已经在我们的思维模式中了。

这就是我们需要了解的所有信息！

### 严格相等：a === b

你可能在以前用过**严格相等**操作符：

```js
console.log(2 === 2); // true
console.log({} === {}); // false
```

还有个对应的反向操作符 `!==` 。

### 同值相等 vs 严格相等

所以 `Object.is` 和 `===` 之间到底有啥区别呢?

同值相等 —— `Object.is(a, b)` —— 在我们的思维模式中有明确的意义。它在我们的宇宙中代表“同一个值”。

在几乎所有的情况中，同样的直觉对于严格相等是一致的。举个例子， `2 === 2` 的值是 `true`， 因为 `2` 总是“表示”同一个值：

![img](https://res.cloudinary.com/dg3gyk0gu/image/upload/v1582304092/just-javascript-email-images/jj06/equality_small.gif)

反过来， `{} === {}` 是 `false` 的原因是因为每个 `{}` 创建了不同的值：

![img](https://res.cloudinary.com/dg3gyk0gu/image/upload/v1582304092/just-javascript-email-images/jj06/inequality_small.gif)

在上面的例子中， `a === b` 与 `Object.is(a, b)` 有相同的表现。然而，有两个例外：

**以下情况是这个规则的例外** —— 就如同你在学习英语时得去记住一些不规则动词一样。所有的特殊情况都涵盖在了我们之前讨论的 “特殊数字” 中：

1. `NaN === NaN` 是 `false`， 尽管它们是同一个值。
2. `-0 === 0` 和 `0 === -0` 是 `true`， 尽管它们是不同的值。

尽管这两种情况很少见，我们还是仔细研究一下它们。

### 第一个特殊案例：NaN















